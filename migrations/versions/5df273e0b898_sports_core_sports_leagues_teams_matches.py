"""sports core (sports/leagues/teams/matches)

Revision ID: 5df273e0b898
Revises: xxxx_seed_plans_abonnement
Create Date: 2025-08-30 01:34:25.084967

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = '5df273e0b898'
down_revision: Union[str, Sequence[str], None] = 'xxxx_seed_plans_abonnement'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('sports',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nom', sa.String(length=50), nullable=False),
    sa.Column('code', sa.String(length=10), nullable=False),
    sa.Column('icone', sa.String(length=100), nullable=True),
    sa.Column('actif', sa.Boolean(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('code'),
    sa.UniqueConstraint('nom')
    )
    op.create_table('championnats',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('sport_id', sa.Integer(), nullable=False),
    sa.Column('nom', sa.String(length=100), nullable=False),
    sa.Column('pays', sa.String(length=50), nullable=True),
    sa.Column('niveau', sa.Integer(), nullable=True),
    sa.Column('saison_actuelle', sa.String(length=20), nullable=True),
    sa.Column('logo_url', sa.String(length=255), nullable=True),
    sa.Column('api_id', sa.String(length=50), nullable=True),
    sa.Column('actif', sa.Boolean(), nullable=False),
    sa.ForeignKeyConstraint(['sport_id'], ['sports.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('equipes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nom', sa.String(length=100), nullable=False),
    sa.Column('nom_court', sa.String(length=50), nullable=True),
    sa.Column('sport_id', sa.Integer(), nullable=False),
    sa.Column('pays', sa.String(length=50), nullable=True),
    sa.Column('logo_url', sa.String(length=255), nullable=True),
    sa.Column('stade', sa.String(length=100), nullable=True),
    sa.Column('api_id', sa.String(length=50), nullable=True),
    sa.ForeignKeyConstraint(['sport_id'], ['sports.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('matchs',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('sport_id', sa.Integer(), nullable=False),
    sa.Column('championnat_id', sa.Integer(), nullable=False),
    sa.Column('equipe_dom_id', sa.Integer(), nullable=False),
    sa.Column('equipe_ext_id', sa.Integer(), nullable=False),
    sa.Column('date_match', sa.TIMESTAMP(), nullable=False),
    sa.Column('journee', sa.Integer(), nullable=True),
    sa.Column('score_dom', sa.Integer(), nullable=True),
    sa.Column('score_ext', sa.Integer(), nullable=True),
    sa.Column('score_mi_temps_dom', sa.Integer(), nullable=True),
    sa.Column('score_mi_temps_ext', sa.Integer(), nullable=True),
    sa.Column('statut', sa.Enum('a_venir', 'en_cours', 'termine', 'reporte', 'annule', name='statut_match_enum'), server_default=sa.text("'a_venir'"), nullable=False),
    sa.Column('minute_actuelle', sa.Integer(), nullable=True),
    sa.Column('api_id', sa.String(length=50), nullable=True),
    sa.Column('importance_match', sa.Integer(), server_default=sa.text('1'), nullable=False),
    sa.Column('diffusion_tv', sa.String(length=255), nullable=True),
    sa.Column('arbitre', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.TIMESTAMP(), server_default=sa.text('CURRENT_TIMESTAMP'), nullable=True),
    sa.Column('updated_at', sa.TIMESTAMP(), server_default=sa.text('CURRENT_TIMESTAMP'), nullable=True),
    sa.ForeignKeyConstraint(['championnat_id'], ['championnats.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['equipe_dom_id'], ['equipes.id'], ondelete='RESTRICT'),
    sa.ForeignKeyConstraint(['equipe_ext_id'], ['equipes.id'], ondelete='RESTRICT'),
    sa.ForeignKeyConstraint(['sport_id'], ['sports.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('ix_matchs_date_statut', 'matchs', ['date_match', 'statut'], unique=False)
    op.create_index('ix_matchs_pairing_date', 'matchs', ['equipe_dom_id', 'equipe_ext_id', 'date_match'], unique=False)
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index('ix_matchs_pairing_date', table_name='matchs')
    op.drop_index('ix_matchs_date_statut', table_name='matchs')
    op.drop_table('matchs')
    op.drop_table('equipes')
    op.drop_table('championnats')
    op.drop_table('sports')
    # ### end Alembic commands ###
